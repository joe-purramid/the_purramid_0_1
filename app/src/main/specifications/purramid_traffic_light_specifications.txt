The traffic light is a vector image of a common traffic light with three colored bulbs: red, yellow, and green. It's default orientation is vertical (with the red light on top and the green light on bottom, with the yellow light in the middle), but the user can change it to be horizontal in the settings (with the red light on the left and the green light on the right, with the yellow light in the middle). When a color is "lit", its color will change from dull to shining (for example, dull red vs shining red colors). There should not be any flashing that might trigger seizures. Each light will also include an image outline that only appears when that light is lit. This is to help color blind users understand which light is active.

At launch, the app should check to see if the device has a mic array or other active mic input. This will be referred to as "mic array" going forward, regardless of what type of microphone is actually being used. The light chnages from red to yellow to green every 0.3 seconds. This sequence happens twice, then all thre elights flash in unison three times, flashing ever 0.3 seconds. Then all lights are unlit. If app initiation requires more than three seconds, the sequence should repeat.

The traffic lights act as buttons in some cases. Users can tap a light to turn it on and off. Aside from the light bulbs, traffic light has two additional buttons, a settings gear button that appears at the bottom left and and a close button made from a unicode cross in a circle at the top right. 

A rounded "Settings" menu button (ic_settings.xml) is attached to the bottom left corner of the mask. When tapped, it gracefully expands a settings menu that includes: "Mode", "Orientation", "Blinking Lights", "Adjust Values", "Add Messages", "Edit Sequence", "Show Time remaining", "Show Timeline", and "Add Another".

Mode: Manual by default; the user can select between three use modes: Manual, Responsive Change, and Timed Change. If the device does not have an active mic input, Responsive Change should be inactivated.

Orientation: Vertical by default; when changed to horizontal, the traffic lights appear horizontally with red then yellow then green from left to right.

Blinking lights: On by default; when turned off, color blinking is ignored whenever mentioned in app behavior. Colors are either lit or unlit based on defined usage and never blink.

Adjust values: Only visible when mode is set to Responsive Change; allows the user to change the decibel values that cause color changes.

Add Messages: Only visible when mode is set to Manual Change or Responsive Change; allows the user to add messages that appear beside the traffic light.

Edit Squence: Only visible when mode is set to Timed Change; allows the user to create/change the time duration and color change for the Timed Change mode

Show Time Remaining: Off by default, only visible when mode is set to Timed Change; shows a countdown timer of the current sequence step.

Show Timeline: Off by default, only visible when mode is set to Timed Change; shows a countdown timer of the current sequence step and time values for all future sequence steps.

Add Another: Create another traffic light instance. If four traffic lights are open, this setting is inactivated.


Manual mode behavior: When a user taps on a color that color is lit. If the user taps on a different color, that first color is unlit and the new color is lit. If the user double-taps on the color that is lit, that color is unlit but no new color is lit.


Responsive mode behavior: When this mode is selected, ambient sound is measured using the mic array. Maxamplitude is measured every two seconds by using standard Google APIs. Based on the decibels (dB) of that sound, a specified color is lit. Green is lit with a measure of 59 dB or less. Yellow is lit with a measure of 60 dB to 79 dB. Red is lit with a measure of 80 dB or higher. If sound changes from one range to antoher, the previous color is unlit and the new color is lit. If a color is within 5 dB of the range above it, the color blinks (between its unlit and lit colors) every 0.5 seconds. This means green would blink from 55 dB to 59 dB and Yellow would blink from 75 dB to 79 dB. Colors do not blink when near a lower range. (For example, moving from 81 dB to 70 dB, red would be lit, but it would not blink.) Because maxamplitude is measured every two seconds, it is possible for decibels to increase or decrease enough to skip a range. In those cases, the color skipped is not shown. (For example,going from 81 dB to 50 dB would cause red to change green without yellow being lit.)

"Adjust Values" opens a window on top of settings. Three color circles form a column on the left (for left-to-right languages) and on the right (for right-to-left languages). Each color then has a minimum and a maximum value text field (following in the same order of left-to-right or right-to-left based on the selected language). The text fields show the default decibel ranges. The string "dB" beside the text field (to the left or right, accordingly). The minimum value for green is 0 and the maximum 59. Yellow is mininimum 60 and maximum 79. Red is minimum 80 and maximum 120. If the user taps on a text field, a cursor appears and the system number pad appears. If a change is made to a value that is adjacent to another value, both values are changed to remain adjacent to one another. (For example, if the maximum of green is changed from 59 to 69, the minimum of yellow would automatically adjust to 70.) If a change is made to a value that crosses the entire range of its adjacent color, the middle color's range is eliminated. The numbers in those fields are replaced with the string N/A. And the other color is one dB away from the modified range. (For example, if the minimum value of red was changed from 80 to 55, the maximum value of green would be set to 54 and both yellow values would be set to N/A.

Below the color ranges is an unchecked checkbox and a string that says "Dangerous Sound Alert". After the string is an information icon (a lowercase i in a circle). If the box is checked and the mic array reports a Maxamplitude value of 150 dB or higher, the red and yellow lights alternate blinking ever 0.2 seconds. In the message field for the red color is the string "WARNING". In the message field for the yellow color is the string "Notify your instructor immediately." In the message field for the green color is the string "Double-tap green to dismiss this alert." If more than one traffic light window is open, all windows display the same alert. Dismissing the alert on one window dismisses it on all of them. The alert must be dismissed before use of the traffic light returns to normal. If all traffic light windows are closed or if the app is destroyed while the alert is active, the alert does not return when the app is reopened.

If the user taps the information icon, a dialog box opens with the following text: "Check this box to display an alert that says "Warning: Notify your instructor immediately." should your hardware's microphone report a sound of 150 decibels or higher. The US Occupational Safety and Health Organization projects the loudest classroom noise would reach 95 dB. 120 db is the sound of a car backfire. 150 dB is the sound of a gunshot. The Purramid is a software application dependent on the readings provided by your microphone. There is no guarantee that the sound detected is 150 db or what made the sound is a firearm. But this is the reality that US students live in, and we are committed to providing teachers any tools possible to make their classrooms places of learning and not fear." (The word Purramid is never translated.) 


"Add Messages" allows the user to add text, an image, and/or emoji to appear beside a color when it is lit (far enough away that they do not overlap with the body of the traffic light). For left-to-right languages, the message appears to the right of the lit color. For right-to-left languages, the message appears to the left of the lit color. The size of the text and emoji should equal 80% of the color circle. Images equal 150% of the color circle, with the center of the image aligning with the center of the color circle. Messages appear when a color is lit and disappear when it is not. A line may include a maximum of 27 text characdters, 10 emoji, and one image. There is one line available for each light. If nothing is entered in a message box, nothing appears on the screen in that space.


Timed Change mode behavior: When switched to Timed Change mode, a play/pause button and a reset button are added to the layout of the traffic light below the body of the traffic light. These buttons are icon buttons only. Their textual names are included in tooltips. The play button initiates the sequence. Until the sequence is initiated, no color is lit. Once the play button is pressed, the first color in the sequence is lit and its corresponding message is displayed. Its duration begins to countdown. This time is not shown unless the "Show Time Remaining" setting is toggled on. When countdown for that sequence row elapses, the next row in the order begins, with that light lit, its message displayed, and its duration beginning to count down. If two rows in a sequence use the same color, the color blinks twice at an interval of 0.3 seconds. This process continues until the sequence complets. At that point, all colors are unlit and all messages are removed.



Once the sequence starts, the play button changes to a pause icon. If the pause button is pressed, sequence time countdown is paused and the button changs to a play icon. Play would then resume the time countdown. If the user presses the reset button while time is running, the current row sequence starts back over at its starting value with time counting down. The lit color blinks once to show the change. If the user presses the reset button while time is paused, the current row of the sequence resets but timing does not resume until the play button is pressed. The lit color blinks once to show the change. If the user double-taps or presses reset twice within 1 second, the traffic light resets to the first row of the sequence. The color that was active when the reset button was double-tapped blinks twice at an interval of 0.3 seconds and then color of the first row of the sequence blinks once more. (If both colors are the same, the light would blink three times at an interval of 0.3 seconds. If the colors were changing from green to red, green would blink twice and red would blink once.) If time was paused, the sequence does not resume until the play button is pressed. If time was actively counting down, the sequence begins counting down immediately. If the entire sequence has elapsed and the user presses reset once, the sequence resets to its last row, and time is paused. If the entire sequence has elapsed and the user double-taps reset, the sequence resets to the first row, and its time is paused.



If Show Time Remaining is toggled on, a digital clock of HH:MM:SS shows beside the active color (far enough away that it does not overlap with the body of the traffic light image). While time is set entirely by minutes in the settings interface, those minutes should be translated to hours, minutes, and seconds. If the set time value is lesson than 10 hours, no tens value is shown for hours (H:MM:SS not HH:MM:SS). If the set time value is less than 1 hour, no hour value is shown. (MM:SS not H:MM:SS). If the set time value is less than 10 minutes, no tens value is shown for minutes (M:SS not MM:SS). If the set time value is less than 1 minute, a minute value of 0 is used (30 seconds displays as 0:30). Thus when 65 is the time value entered in settings, 1:05:00 would display on the clock. After five minutes elapsed, the hour value would be removed and the clock would read 59:59 and continue counting down. 



If Show Timeline is toggled on a line the length of the traffic light appears beside it (far enough away that it does not overlap with the body of the traffic light image. Color circles with black outlines appear on the line from top to bottom in the order in which they appear in the sequence. Their position on the timeline is dependent on where in the total length of time they begin. If I had a squence with three rows, with the first row lasting 10 minutes and the other two lasting 5, the first color circle would appear at the top of the timeline. The second color circle would appear 50% of the way down the line. The third color circle would appear 75% of the way down the line. The end of the line is an empty circle. When time begins counting down, the color circle begins moving down the timeline at a speed that causes it to reach the next circle when its set time elapses. An empty circle appears where the color originally started. As it reaches the next circle, it moves behind that next color circle. When it is fully obscured, time for that sequence row has ellapsed, its color disappears, and the next color in the sequence begins to move down the timeline, leaving a second empty circle. When the final sequence color reaches the final, empty circle, it obscured by the no-fill. When it is fully obscured and an empty circle remains, the entire sequence has elapsed. Hitting the reset button returns the color to its starting circle. If Show Remaining Time is also toggled on, a clock appears at the midpoint of each line segment for its respective row in the sequence. When that time reaches 0:00, it disappears, and the next clock starts counting down.



Edit Sequence is as follows: This opens a window similar in design to an Android alarm interface. If a user has created sequences, they are organized alphabetically in a column. The last item in a column is the string "Create New Sequence". There can be a maximum of ten sequences saved. With the creation of the tenth sequence, the "Create New Sequence" option goes away.



When the user creates a new sequence, a list editing interface opens up. At the top is a text field with the string "Title" in it. When the user taps this field, the word "Title disappears" and a cursor appears. The sytsem keyboard opens. They can enter a title for this sequence up to 27 characters long. Below is a sequence row made up of multiple elements. These elements go left-to-right or right-to-left to match the system language. The first item is a drag handle (two parallel lines). A dragging motion on this handle allows the user to change the row's order in the stack. The second element is the number where this row appears in the order. If the user drags the row to a new position, this value automatically updates. The third element is a circle button with a black outline. This button opens up a color picker of three color circles, red, yellow, or green. If no color has been selected, the circle fill is 1/3 red, 1/3 yellow, and 1/3 green in vertical columns. The next element is a text field with the number 0 in it. If the user taps on this field, a cursor appears and the system number pad opens. The number they place here equals minutes until the next change. The maximum number permitted is 999. The final element is a message field exactly as described for Add Message above. The string "Add a message" appears in this text field. When the user taps this text field, the string disappears, a cursor appears, and the system keyboard opens. If the user does not add a message, the string does not display when the traffic light is in use. When the user begins to enter values in any of these fields, a new row appears beneath it. A user can create a sequence with no more than ten rows. When they reach their tenth row, no new row is populated.
