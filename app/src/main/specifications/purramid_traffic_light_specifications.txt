// the_purramid_0_1\app\src\main\specifications
// TrafficLightService.kt
The traffic light is a vector image of a common traffic light with three colored "bulbs" or "llights": red, yellow, and green. One bulb can be lit at a time, used by the teacher to better manage the classroom.


 --- RUNTIME EVENTS ---
(1) On launch, the traffic light 
	(1.1) checks if the system has a mic array or other active mic input
		(1.1.1)This will be referred to as "mic array" going forward, regardless of what type of microphone is actually being used. 
	(1.2) opens in a windowed state.
		(1.2.1) Windowed desscribes the user experience. Traffic Light launches a service. 
		(1.2.1) Whether it is using an overlay or an Android window, both will be referred to as "windowed" for the purposes of these specifications.
	(1.3) activates red then yellow then green every 0.3 seconds. 
		(1.3.1) When one light activates, the previous one returns to default. 
		(1.3.2) Repeat the sequence once
		(1.3.3) Following the second sequence, all thre elights flash default-active-default in unison three times, flashing every 0.3 seconds. 
		(1.3.4) Following (1.3.3), all lights return to default. 
		(1.3.5) If app initiation requires more than three seconds, the sequence should repeat.
		(1.3.6) If "Blinking Lights" is toggled off in the user settings, this sequence is ignored. Lights remain in default during startup.
(2) The most recent traffic light user preferences are saved. Save the following:
	(2.1) Traffic light size
	(2.2) Mode
	(2.3) Orientation toggle, vertical or horizontal state
	(2.4) Blinking lights toggle on/off state
	(2.5) Adjusted values
			(2.5.1) Adjusted values are saved regardless of whether the final mode is Responsive Change or not. It is possible for a user to modify values in Responsive Change mode and then change to Manual mode or Timed Change mode.
	(2.6) Added messages
			(2.6.1) Added messages are saved regardless of the final mode.
	(2.7) Sequences
			(2.7.1) Sequences are saved regardless of the final mode.
	(2.8) Show time remaining toggle on/off state
	(2.9) Show timeline toggle on/off state
	(2.10) Traffic light position on the screen if not full-screen
(3) On future app-intent launches, the traffic light loads saved user preferences.


 --- USER INTERFACE ---
(4) The body of the traffic light is a yellow rectangle similar to this picture: https://www.insurancejournal.com/app/uploads/2012/09/traffic-lights.jpg
	(4.1) It includes three "bulbs" or "lights". These are circle with a black outline and the following fill colors: 
		(4.1.1) Red
			(4.1.1.1) Default state is #B81B0E
			(4.1.1.2) Active state is #FF0000
		(4.1.2) Yellow
			(4.1.2.1) Default state is #B8BB0E
			(4.1.2.2) Active state is #FFFF00
		(4.1.3) Green
			(4.1.3.1) Default state is #549C30
			(4.1.3.2) Active state is #00FF00
		(4.1.4) An active light also includes the image ic_mask_stamp.xml.
			(4.1.4.1) The image's width is equal to 0.6f of the bulb's circle diameter.
                (4.1.4.1.1) The image's height should adjust proportionately to its width.
	(4.2) A traffic light can appear in one of two orientations based on user settings choices:
		(4.2.1) Vertical (the default orientation)
			(4.2.1.1) The red light is on top.
			(4.2.1.2) The yellow light is in the middle.
			(4.2.1.3) The green light is on the bottom.
		(4.2.2) Horizontal
			(4.2.2.1) The red light is on the left.
			(4.2.2.2) The yellow light is in the middle.
			(4.2.2.3) The green light is on the right.
(5) A Settings button is positioned in the bottom left corner.
	(5.1) Default icon state uses ic_settings.xml.
	(5.2) Active state: Programmatically change fill colors for default state icons to #808080.
(6) A Close button is positioned in the top right corner.
	(6.1) Default icon state uses ic_close.xml.
	(6.2) Active state: Programmatically change fill colors for default state icons to #808080.
		

 --- USER EXPERIENCE ---
(8) ``SETTINGS``
	(8.1) When a user touches the settings button, its icon changes from (5.1) Default to (5.2) Active.
	(8.2) When activated, a settings menu extends with a smooth transition animation from the settings button.
		(8.2.1) The settings button remains active while the settings window is open.
		(8.2.2) The settings window is rows of text and an icon:
			(8.2.2.1) "Mode"
				(8.2.2.1.1) Following the word "Mode" is a drop-down menu.
					(8.2.2.1.1.1) The default mode is Manual
					(8.2.2.1.1.2) Following the word "Manual" is a drop-down arrow
						(8.2.2.1.1.2.1) The drop-down arrow's default state is ic_arrow_drop_down.xml
						(8.2.2.1.1.2.2) The drop-down arrow's active state is ic_arrow_drop_up.xml
				(8.2.2.1.1) When tapping anywhere in the drop-down menu (text or arrow)
					(8.2.2.1.1.1) A drop-down menu smoothly opens overtop the settings menu
					(8.2.2.1.1.2) A list of mods is displayed in this order from the top down:
						(8.2.2.1.1.2.1) Manual
						(8.2.2.1.1.2.2) Responsive Change
                            (8.2.2.1.1.2.2.1) If no mic array is detected, Responsive Change is hidden.
						(8.2.2.1.1.2.3) Timed Change
			(8.2.2.2) "Orientation"
				(8.2.2.2.1) Following the word "Orientation" is a toggle.
					(8.2.2.2.1.1) The toggle's default position is off.
			(8.2.2.3) "Blinking Lights"
				(8.2.2.3.1) Following the phrase "Blinking Lights is a toggle.
					(8.2.2.3.1.1) The toggle's default position is on.
			(8.2.2.4) "Adjust Values"
				(8.2.2.4.1) Following the phrase "Adjust values" is an edit icon
					(8.2.2.4.1) Default icon state uses ic_edit.xml.
					(8.2.2.4.2) Active state: Programmatically change fill colors for default state icons to #808080.
			(8.2.2.5) "Add Messages"
				(8.2.2.5.1) Following the phrase "Add Messages" is an edit icon
					(8.2.2.5.1) Default icon state uses ic_edit.xml.
					(8.2.2.5.2) Active state: Programmatically change fill colors for default state icons to #808080.
			(8.2.2.6) "Edit Sequence"
				(8.2.2.4.1) Following the phrase "Adjust values" is an edit icon
					(8.2.2.4.1) Default icon state uses ic_edit.xml.
					(8.2.2.4.2) Active state: Programmatically change fill colors for default state icons to #808080.
			(8.2.2.8) "Show Time Remaining"
				(8.2.2.8.1) Following the phrase "Show Time Remaining" is a toggle.
					(8.2.2.8.1.1) The toggle's default position is off.
			(8.2.2.9) "Show Timelline"
				(8.2.2.2.1) Following the phrase "Show Timeline" is a toggle.
					(8.2.2.2.1.1) The toggle's default position is off.
			(8.2.2.10) "Add Another"
				(8.2.2.10.1) Following the phrase "Add Another" is an add icon.
					(8.2.2.10.1.1) The default icon state is ic_add_circle.xml.
					(8.2.2.10.1.2) The active state icon programatically changes the fill color of the default icon to #808080.
	(8.3) When deactivated, the settings menu folds back into the settings button with a smooth transition animation.
		(8.3.1) A user choosing a setting (e.g., orientation) deactivates the settings menu.
		(8.3.2) A user touching outside of the settings window deactivates the settings menu.
		(8.3.3) A user touching the settings button deactivates the settings menu.
		(8.3.4) The settings button returns to default icon state
        
(9) ``ORIENTATION``
    (9.1) When the orientation setting toggle state is left, the traffic light is oriented vertically.
    (9.2) When the orientation setting toggle state is right, the traffic light is oriented horizontally.
    
(10) ``BLINKING LIGHTS``
    (9.1) When the Blinking Lights setting toggle state is on, lights blink wherever defined in the specifications.
    (9.2) When the Blinking Lights setting toggle state is off, lights do not blink regardless of specifications.
    (9.3) The toggle should include the words "On" and "Off"
        (9.4) These words should be strings so they can be translated.
        
(11) ``ADJUST VALUES``
    (11.1) Adjust Values setting is only visible when the Traffic Light mode is set to Responsive Change.
    (11.2) When the edit icon for Adjust Values is activated, a window expands with a smooth transition animation.
        (11.2.1) This window includes:
            (11.2.1.1) A back arrow in the top left corner of the window. 
            	(11.2.1.1.1) Default icon state uses ic_back.xml.
                (11.2.1.1.2) Active state: Programmatically change fill colors for default state icons to #808080.
                (11.2.1.1.3) When activated the Adjust Values window closes.
                    (11.2.1.1.3.1) The user returns to the main settings window.
            (11.2.1.2) A close button in the top right corner of the window.
            	(11.2.1.2.1) Default icon state uses ic_close.xml.
                (11.2.1.2.2) Active state: Programmatically change fill colors for default state icons to #808080.
                (11.2.1.2.3) When activated all settings related windows close.
            (11.2.1.3) A decibel (dB) range table.
                (11.2.1.3.1) The first column is three color circles.
                    (11.2.1.3.1.1) The order of the lights matches the order of a vertical traffic light.
                (11.2.1.3.2) The second column is three text fields. (These are the minimum decibel levels for the light colors.)
                    (11.2.1.3.2.1) Each text field aligns with one of the three lights from (11.2.1.3.1).
                    (11.2.1.3.2.2) The first row (red light) displays the number "80".
                    (11.2.1.3.2.3) The second row (yellow light) displays the number "60".
                    (11.2.1.3.2.4) The third row (green light) displays the number "0".
                (11.2.1.3.3) The third column has three rows, each with the same string, "dB".
                (11.2.1.3.4) The fourth column has three rows, each with a hyphen.
                (11.2.1.3.5) The fifth column is three text fields. (These are the maximum decibel levels for the light colors.)
                    (11.2.1.3.5.1) Each text field aligns with one of the three lights from (11.2.1.3.1).
                    (11.2.1.3.5.2) The first row (red light) displays the number "120".
                    (11.2.1.3.5.3) The second row (yellow light) displays the number "79".
                    (11.2.1.3.5.4) The third row (green light) displays the number "59".
                (11.2.1.3.6) The sixth column has three rows, each with the same string, "dB".
            (11.2.1.4) If the user taps on a text field:
                (11.2.1.4.1) The system number pad opens.
                (11.2.1.4.2) The smallest value any text field can be set to is 0.
                (11.2.1.4.3) The largest value any text field can be set to is 149.
            (11.2.1.5) When the minimum value of a light is changed, the adjacent maximum value changes also.
                (11.2.1.5.1) A minimum decibel level value is always 1 away from the next light's maximum decibel value.
                (11.2.1.5.2) For example, if the minimum decibel level for yellow is changed from 60 to 65, the maximum decibel level for green changes from 59 to 64.
            (11.2.1.6) When the maximum value of a light is changed, the adjacent minimum value changes also.
                (11.2.1.6.1) A maximum decibel level value is always 1 away from the next light's minimum decibel value.
                (11.2.1.6.2) For example, if the maximum decibel level for yellow is changed from 79 to 74, the minimum decibel level for red changes from 80 to 75.
            (11.2.1.7) If a change to the green maximum or the red minimum is larger than the entirety of the yellow range, the yellow text fields change to the string N/A.
                (11.2.1.7.1) For example, if the minimum value of red was cahnged from 80 to 60 and the green maximum value was still set to 59, yellow would display the string N/A.
                (11.2.1.7.2) If the minimum value of red was changed from 80 to 55 and the green maximum value was still set to 59:
                    (11.2.1.7.2.1) Yellow would display the string N/A.
                    (11.2.1.7.2.2) The green maximum value would change to 54.
            (11.2.1.8) Below the decibel table, there is:
                (11.2.1.8.1) A checkbox
                (11.2.1.8.2) A string that says "Dangerous Sound Alert"
                (11.2.1.8.3) This string is followed by an information 
					(11.2.1.8.3.1) The default icon state is ic_info.xml.
					(11.2.1.8.3.2) The active state icon programatically changes the fill color of the default icon to #808080.
            (11.2.1.9) If the user touches the checkbox, an X appears in the checkbox, marking it as active
            (11.2.1.10) If the user touches the information button:
                (11.2.1.10.1) A snackbar opens with the following string: "Check this box to display an alert that says "Warning: Notify your instructor immediately." should your hardware's microphone report a sound of 150 decibels or higher. The US Occupational Safety and Health Organization projects the loudest classroom noise would reach 95 dB. 120 db is the sound of a car backfire. 150 dB is the sound of a gunshot. The Purramid is a software application dependent on the readings provided by your microphone. Purramid Learning® makes no guarantee that the sound detected is 150 db or what made the sound is a firearm. But this is the reality that US students live in, and we are committed to providing teachers any tools possible to make their classrooms places of learning and not fear."
                    (11.2.1.10.1.1) The word "Purramid" is never translated.
                    (11.2.1.10.1.2) The phrase "Purramid Learning®" is never translated.
            
(12) ``DANGEROUS SOUND ALERT``
    (12.1) If the traffic light app intent detects a sound at 150 dB or louder:
        (12.1.1) It overrides any mode parameters currently in effect.
        (12.1.2) The following message is displayed beside the traffic light.
            (12.1.2.1) Aligned with the red light: "Warning"
            (12.1.2.2) Aligned with the yellow light: "Notify your instructor immediately."
            (12.1.2.3) Aligned with the green light: "Double-tap green to dismiss this alert."
        (12.1.3) The red and yellow lights alternate blinking every 0.2 seconds.
            (12.1.3.1) This blinking overrides the "Blinking Lights" setting.
    (12.2) If multiple traffic lights have been opened (as per "Add Another"), all traffic lights implement (12.1).
    (12.3) If the user double-taps the green light, the behavior of all traffic lights returns to its previous settings.
        (12.3.1) As long as the Dangerous Sound Alert checkbox is active, future sounds of 150 dB or louder can trigger this event again.
    (12.4) If all app windows are closed, the app is killed, or an onDestroy event occurs while the Dangerous Sound Alert is active, it is no longer active when the app reopens.

(13) ``ADD MESSAGES``
    (13.1) Add Messages setting is only available when the Traffic Light mode is set to Manual or Responsive Change.
    (13.2) When the edit icon for Add Messages is activated, a window expands with a smooth transition animation.
        (13.2.1) This window includes:
            (13.2.1.1) A back arrow in the top left corner of the window. 
            	(13.2.1.1.1) Default icon state uses ic_back.xml.
                (13.2.1.1.2) Active state: Programmatically change fill colors for default state icons to #808080.
                (13.2.1.1.3) When activated the Adjust Values window closes.
                    (13.2.1.1.3.1) The user returns to the main settings window.
            (13.2.1.2) A close button in the top right corner of the window.
            	(13.2.1.2.1) Default icon state uses ic_close.xml.
                (13.2.1.2.2) Active state: Programmatically change fill colors for default state icons to #808080.
                (13.2.1.2.3) When activated all settings related windows close.
            (13.2.1.3) A messages table.
                (13.2.1.3.1) The first column is three color circles.
                    (13.2.1.3.1.1) The order of the lights matches the order of a vertical traffic light.
                (13.2.1.3.2) The second column is three text fields.
                    (11.2.1.3.2.1) Each text field aligns with one of the three lights from (13.2.1.3.1).
                    (11.2.1.3.2.2) Each text field includes 
                        (11.2.1.3.2.2.1) The string "Add Message" in gray text
                        (11.2.1.3.2.2.2) An add emoji button
                        (11.2.1.3.2.2.3) An upload image button
        (13.2.2) If a user touches a text field:
            (13.2.2.1) The string "Add Message" disappears.
            (13.2.2.2) The system keyboard opens.
        (13.2.3) A text field can include a maximum of:
            (13.2.3.1) 27 characters
            (13.2.3.2) 10 emoji
            (13.2.3.3) One image
	(13.3) Messages:
		(13.3.1) Appear when their assigned colors are active.
		(13.3.2) Disappear when their assigned colors are default.
		(13.3.3) Situated outside the body of the traffic light vector image, aligned with their assigned light.
		(13.3.4) Text and emoji are 0.8f the size of the bulb.
		(13.3.5) Images are 1.5f the size of the bulb
			(13.3.5.1) Images are centered with the bulb, so their excess height  is equally distributed above and below the light.
	(13.4) If nothing is entered in message fields, no screen space is dedicated to messages.
                    
(14) ``EDIT SEQUENCE``
    (14.1) Edit Sequence setting is only available when the Traffic Light mode is set to Timed Change.
    (14.2) When the edit icon for Edit Sequence is activated, a window expands with a smooth transition animation.
	(14.3) The layout of this window is similar to the layout of the system alarm clock
		(14.3.1) Up to ten sequences can be created.
			(14.3.1.1) If there are fewer than ten sequences, the first row shown is always "Create New Sequence"
			(14.3.1.2) If there are ten sequences, "Create New Sequence" is not visible.
		(14.3.2) Existing sequences are ordered alphanumerically by title.
	(14.4) A sequence row includes the following:
		(14.4.1) The sequence title
		(14.4.2) A circle for each step of the sequence.
			(14.4.2.1) Each circle has a black outline.
			(14.4.2.2) Each cirle fill matches the color assigned for that step of the sequence.
			(14.4.2.3) Circles are ordered to match their order in the sequence.
				(14.4.2.3.1) For example, if a sequence has three steps, with steps 1 and 2 assigning a red light and step 3 assigning a green light, three circles would appear in order of red-red-green.
		(14.4.3) The sum total of all the steps.
			(14.4.3.1) For example, if a sequence has three steps, each 30 minutes long, time displayed would be 1:30:00
	(14.5) If a user taps a sequence, it opens a sequence editor view
		(14.5.1) The top of this view is a title text field.
			(14.5.1.1) If no title has been previously entered, there is a string "Sequence Title"
			(14.5.1.2) If a title has been previously entered, it appears here.
			(14.5.1.3) If the user taps the text field
				(14.5.1.3.1) the "Sequence Title" string disappears (if it was present).
				(14.5.1.3.2) the system keyboard opens.
					(14.5.1.3.2.1) A title may not be longer than 27 characters.
		(14.5.2) Below the title are 




		(14.4.1) A reorder handle (ic_drag_handle.xml)
			(14.4.1.1) If the user pres-hold-drag the handle, the row moves with a smooth animation and can be placed elsewhere in the order.
			(14.4.1.2) When the user lifts their finger, the animation ends and the sequence row fits back in with the larger list.
		(14.4.2) A numerical value of the row's order.
			(14.4.2.1) Rows are numbered sequentially, beginning at 1, from top of the order to the bottom.
			(14.4.2.2) If the row changes order, per (14.4.1), this number updates accordingly.
		(14.4.3) A circle with
			(14.4.3.1) A black outline
			(14.4.3.2) A fill that shows the assigned color
		(14.4.4) The duration


				(14.4.3.2.1) When the user touches this button, a menu opens with a smooth animation.
					(14.4.3.2.1.1) It displays three circles, one for each color of the traffic light.
					(14.4.3.2.1.2) When the user touches one of those colors
						(14.4.3.2.1.2.1) That color is assigned to the sequence.
						(14.4.3.2.1.2.2) The circle fill in the sequence row changes to the assigned color.
						(14.4.3.2.1.2.3) The color selection menu folds closed with a smooth animation.
					(14.4.3.2.1.2) If a user taps on the Edit Sequence window (and not on one of the three colored circles), the color seelction menu folds closed with a smooth animation.
				(14.4.3.2.1) If no color has been assigned yet, the fill is divided into 1/3 red, 1/3 yellow, and 1/3 green
					(14.4.3.2.1.1) If a user attempts to create a sequence without assigning a color, a snackbar appears that says, "Please assign a color to continue."
				(14.4.3.2.2) A circle may never be assigned more than one color.
		(14.4.4) A text field for time duration
			(14.4.4.1) If no time has been entered, the text field includes the string "H:MM:SS"
				(14.4.4.1.1) If a user attempts to create a sequence without assigning a color, a snackbar appears that says, "Please set a time duration to continue."
			(14.4.4.2) If the user taps into the text field
				(14.4.4.2.1) The string "H:MM:SS" disappears
				(14.4.4.2.2) The system numberpad opens.
					(14.4.4.2.2.1) Numbers entered populate seconds, then minutes, then hours.
						(14.4.4.2.2.1.1) For example, if a user enters 30, that is 30 seconds.
						(14.4.4.2.2.1.2) If a user enters 53030, that is 5 hours, 30 minutes, and 30 seconds.
					(14.4.4.2.2.2) Time cannot be set at a value larger than 9:59:59
			(14.4.4.3) If time has been entered, that time is displayed in a similar format.
				(14.4.4.3.1) For example, if the user entered 30 minutes, it would display as "0:30:00".
		(14.4.5) A text field for a message XXX
			(14.4.5.1) This matches the functionality of (13) Add Messages, but for Timed Change mode. 




They can enter a title for this sequence up to 27 characters long. Below the title is a row with the following elements ordered left to right: (16) two parallel lines used as a reordering drag handle (ic_drag_handle.xml); (17) the numerical value of the row's position in the order, descending sequentially (starting at number 1); (18) a circle with fill 1/3 red, 1/3 yellow, and 1/3 green;  (19) a text field with "H:MM:SS: shown in it; and (20) a message field. If changes are made to the first row of a sequence, a second row appears with all the same default values as the first row except that the sequence order number increases by 1. A user can create a sequence with no more than ten rows. When they reach their tenth row, no new row is populated.

(16) A dragging motion on the reordering handle handle allows the user to change the row's order in the stack. Gracefully animate the row's movement above and insertion back into the sequence order.

(17) This number shows the order value of the row. When a row is moved in the order, the numbers change to match the new sequence order. Numbers should always be in sequence.

(18) when tapped, this circle opens a column view similar to (10) that shows three circles one with red fill, one with yellow, and one with green. When the user taps a specific color, the (18) circle fills entirely with that color. This is the color that is lit during this sequence step.

(19) This is the length of time a sequence lasts. When the user taps into the text field, the text disappears and the system number pad opens. The maximum amount of time per sequence step is 9 hours, 59 minutes, and 59 seconds (displayed H:MM:SS). Colons are added automatically. If a user enters 30, this is 30 seconds and displays as 0:00:30. If the user enters 300, this is 3 minutes, and displays as 0:03:00.

(20) This message field behaves the same as message fields in (5). Any message entered displays while this sequence step is active. If no message is netered, nothing displays.



(15) ``SHOW TIME REMAINING``


(16) ``SHOW TIMELINE``


(17) ``Add Another``
	(14.1) When a user touches the Add Another button, its icon changes from (10.2.2.4.1) Default to (10.2.2.4.2) Active.
	(14.2) When Add Another is activated:
		(14.2.1) The Add Another button returns to its default state.
		(14.2.2) A new mask appears at the geometric center of the screen.
			(14.2.2.1) The new mask adopts the properties of the mask from which it was made.
				(14.2.2.1.1) It has the same height and width.
				(14.2.2.1.2) If the source mask had a billboard image, that image appears in the new mask as well.
			(14.2.2.2) If another mask already exists at the geometric center of the display screen, the new mask should appear in an offset position (e.g., +25px down and +25px right) from the centered mask.
	(14.3) If four masks are already present on the screen, 
		(14.3.1) The Add Another button is inactivated. Nothing happens if a user touches it.
		(14.3.2) The icon fill and outline colors change. (TODO: Define specific hex colors for an inactive icon.)


(18) ``MANUAL MODE``


(19) ``RESPONSIVE CHANGE MODE``


(20) ``TIMED CHANGE MODE``


(21) ``CLOSE``
	(15.1) When a user touches the Close button, its icon changes from (6.1) Default to (6.2) Active.
	(15.2) The mask to which the Close button is attached closes.
		(15.2.1) When a mask is closed:
			(15.2.1.1) If it is the only mask currently open, its size, lock state, and position (if not fullscreen) are saved as the most recent user preferences, as per (2).
			(15.2.1.2) If it is one of multiple masks currently open, its preferences are cleared.
		(15.2.2) If the mask is the only mask open, the screen mask service ends.






(7) Show Time Remaining: Off by default, only visible when mode is set to Timed Change; shows a countdown timer of the current sequence step.

(8) Show Timeline: Off by default, only visible when mode is set to Timed Change; shows a countdown timer of the current sequence step and time values for all future sequence steps.

(9) Add Another: Create another traffic light instance. If four traffic lights are open, this setting is inactivated. This follows the behavior in the purramid_universal_requirements.txt.


(1a) Manual mode behavior: When a user taps on a color that color is lit. If the user taps on a different color, that first color is unlit and the new color is lit. If the user double-taps on the color that is lit, that color is unlit but no new color is lit.


(1b) Responsive mode behavior: When this mode is selected, ambient sound is measured using the mic array. Maxamplitude is measured every two seconds by using standard Google APIs. Based on the decibels (dB) of that sound, a specified color is lit. Green is lit with a measure of 59 dB or less. Yellow is lit with a measure of 60 dB to 79 dB. Red is lit with a measure of 80 dB or higher. If sound changes from one range to antoher, the previous color is unlit and the new color is lit. If a color is within 5 dB of the range above it, the color blinks (between its unlit and lit colors) every 0.5 seconds. This means green would blink from 55 dB to 59 dB and Yellow would blink from 75 dB to 79 dB. Colors do not blink when near a lower range. (For example, moving from 81 dB to 70 dB, red would be lit, but it would not blink.) Because maxamplitude is measured every two seconds, it is possible for decibels to increase or decrease enough to skip a range. In those cases, the color skipped is not shown. (For example,going from 81 dB to 50 dB would cause red to change green without yellow being lit.)




(1c) Timed Change mode behavior: When switched to Timed Change mode, a play/pause button and a reset button are added to the layout of the traffic light below the body of the traffic light. The play button initiates the sequence. Until the sequence is initiated, no color is lit. Once the play button is pressed, the first color in the sequence is lit and its corresponding message is displayed. Its duration begins to countdown. This time is not shown unless the (7) "Show Time Remaining" setting is toggled on. When countdown for that sequence row elapses, the next row in the order begins, with that light lit, its message displayed, and its duration beginning to count down. This process continues until the sequence complets. At that point, all colors are unlit and all messages are removed. If two rows in a sequence use the same color, the color blinks twice at an interval of 0.3 seconds. 




When the user presses the play button, the sequence starts. The play icon changes to a pause icon. If the pause button is pressed, sequence time countdown is paused and the button changes to a play icon. Pressing play resumes the time countdown. If the user presses the reset button while time is running, the current row sequence starts back over at its starting value with time counting down. The lit color blinks once to show the change. If the user presses the reset button while time is paused, the current row of the sequence resets but timing does not resume until the play button is pressed. The lit color blinks once to show the change. If the user presses reset when time is paused and the sequence is at its starting value, the traffic light resets to the first row of the sequence. The color that was active blinks twice at an interval of 0.3 seconds and then the color of the first row of the sequence blinks once more. (For example, if the colors were changing from green to red, green would blink twice and red would blink once.) If both colors are the same, the light would blink three times at an interval of 0.3 seconds. The sequence does not resume timing until the play button is pressed. If the entire sequence has elapsed, behavior remains the same. Pressing reset restores the last step of the sequence and timing is paused. If the user presses reset again, the sequence entirely resets.


If (7) Show Time Remaining is toggled on, a digital clock of HH:MM:SS shows beside the active color (far enough away that it does not overlap with the body of the traffic light image). If the time value is lesson than 1 hour, no hour value is shown (MM:SS not H:MM:SS). This is intentionally different than how time displays when (19) time is set in (6) Edit Sequence. If the time value is less than 10 minutes, no tens value is shown for minutes (M:SS not MM:SS). If the time value is less than 1 minute, a minute value of 0 is used (30 seconds displays as 0:30). Thus when one hour and 5 minutes counts down to 59 minutes, time would go from 1:05:00 to 59:00. 



If (8) Show Timeline is toggled on a line the length of the traffic light appears beside it (far enough away that it does not overlap with the body of the traffic light image). Color circles with black outlines appear on the line from top to bottom in the order in which they appear in the sequence. Their position on the timeline is dependent on where in the total length of time they begin. If I had a squence with three rows, with the first row lasting 10 minutes and the other two lasting 5, the first color circle would appear at the top of the timeline. The second color circle would appear 50% of the way down the line. The third color circle would appear 75% of the way down the line. The end of the line is an empty circle. When time begins counting down, the color circle begins moving down the timeline at a speed that causes it to reach the next circle when its set time elapses. An empty circle appears where the color originally started. As it reaches the next circle, it moves behind that next color circle. When it is fully obscured, time for that sequence row has ellapsed, its color disappears, and the next color in the sequence begins to move down the timeline, leaving a second empty circle. When the final sequence color reaches the final, empty circle, it obscured by the no-fill. When it is fully obscured and an empty circle remains, the entire sequence has elapsed. Hitting the reset button returns the color to its starting circle. If (7) Show Remaining Time is also toggled on, a clock appears at the midpoint of each line segment for its respective row in the sequence. When that time reaches 0:00, it disappears, and the next clock starts counting down.


